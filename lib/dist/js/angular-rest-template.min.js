angular.module("com.devnup.rest.cache.storage",["ngStorage"]).factory("$storageWrapper",["$rootScope","$localStorage","$sessionStorage",function(a,b,c){if(!b||!c)throw new Error("ngStorage is required");var d=function(a){var b=a.$default;return a.$default=function(){return b.apply(arguments),a},a};return{$local:function(){return d(b)},$session:function(){return d(c)}}}]),angular.module("com.devnup.rest.cache",["com.devnup.rest.cache.storage"]).factory("$cache",["$storageWrapper",function(a){var b=a.$local().$default({bucket:{},config:{min:5e3,max:6e4}}),c=function(a,c){return c=c||{},b[a]={createdAt:Date.now(),lastUpdated:Date.now(),refresh:c.refresh,_data:{},timeout:{min:c.min||b.config.min,max:c.max||b.config.max}},e(a)},d=function(a){a?b[a]={}:b={}},e=function(a){var c=JSON.parse(JSON.stringify(b[a]));return c.refresh=function(){b[a].refresh&&b[a].refresh().success(function(c){b[a].lastUpdated=Date.now(),b[a]._data=c})},c.data=function(){return b[a]._data},c.clear=function(){d(a)},c},f=function(a){return b[a]?e(b[a]):c.apply(arguments)};return{bucket:function(a){return f.apply(this,[a])},destroy:function(a){return d.apply(this,[a])},config:function(a){a=a||{};for(var c in a)a.hasOwnProperty(c)&&(b.config[c]=a[c]||b[c])}}}]),angular.module("com.devnup.rest",["com.devnup.rest.cache","com.devnup.rest.util"]).factory("$rest",["$restUtil","$http","$cache",function(a,b){var c="/api/",d=!1;return{callback:a.callback,config:function(a){c=a.base,d=a.cache},get:function(e,f){var g=b.get;return d?$cache.bucket(e,{refresh:function(){a.wrapper.apply(this,[c+e,f])}}):a.wrapper(g,[c+e,f])},post:function(d,e){return a.wrapper(b.post,[c+d,e])},put:function(d,e){return a.wrapper(b.put,[c+d,e])},"delete":function(d,e){return a.wrapper(b["delete"],[c+d,e])}}}]),angular.module("com.devnup.rest.util",[]).factory("$restUtil",[function(){if(!async)throw new Error("async is required");return async.wrapper=function(a,b){var c={success:angular.noop,error:angular.noop};a.apply(this,b).success(function(a){c.success(a)}).error(function(a){c.error(a)});var d={success:function(a){return c.success=a,d},error:function(a){return c.error=a,d},cache:function(){return d}};return d},async.callback=function(a){var b={success:angular.noop,error:angular.noop};a=a||{},a.method=a.method||angular.copy(b),a.success=a.success||angular.noop,a.error=a.success||angular.noop,a.method.success(function(c){c.error?(a.error(c.error),b.error(c.error)):(a.success(c),b.success(c))}).error(function(c){a.error(c),b.error(c)});var c={success:function(a){return b.success=a,c},error:function(a){return b.error=a,c}};return c},async}]);