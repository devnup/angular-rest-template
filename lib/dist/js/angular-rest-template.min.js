angular.module("com.devnup.rest.cache.storage",["ngStorage"]).factory("$storageWrapper",["$rootScope","$localStorage","$sessionStorage",function(a,b,c){if(!b||!c)throw new Error("ngStorage is required");return{$local:function(){return b},$session:function(){return c}}}]),angular.module("com.devnup.rest.cache",["com.devnup.rest.cache.storage","com.devnup.rest.util"]).factory("$cache",["$storageWrapper","$restUtil",function(a,b){a.$local().$default({bucket:{},config:{min:5e3,max:6e4}});var c={},d=a.$local(),e=function(a,b){return b=b||{},c[a]=b.refresh||angular.noop,d[a]={createdAt:Date.now(),lastUpdated:Date.now(),refreshing:!1,_data:{},timeout:{min:b.min||d.config.min,max:b.max||d.config.max}},g(a)},f=function(a){a?d[a]={}:d={}},g=function(a,e,g){return g&&g.refresh&&(c[a]=g.refresh),e.refresh=function(){if(c[a]){var f=!!e._data,h=Date.now()-e.lastUpdated,i={min:g.min||e.timeout.min||d.config.min,max:g.max||e.timeout.max||d.config.max};if(!e.refreshing&&(!f||h>i.min))return e.refreshing=!0,b.callback({method:c[a](),success:function(a){e.lastUpdated=Date.now(),e._data=a,e.refreshing=!1},error:function(){e.refreshing=!1}})}var j={error:function(){return j},success:function(a){return a(e._data),j}};return j},e.data=function(){return e._data},e.clear=function(){f(a)},e},h=function(a,b){return d[a]?g(a,d[a],b):e.apply(this,arguments)};return{bucket:function(a,b){return h.apply(this,[a,b])},destroy:function(a){return f.apply(this,[a])},config:function(a){a=a||{};for(var b in a)a.hasOwnProperty(b)&&(d.config[b]=a[b]||d[b])}}}]),angular.module("com.devnup.rest",["com.devnup.rest.cache","com.devnup.rest.util"]).factory("$rest",["$restUtil","$http","$cache",function(a,b,c){var d="/api/",e=!1,f=function(){return!!e};return{callback:a.callback,config:function(a){d=a.base,e=a.cache},get:function(e,g){var h=b.get;if(f()){var i=c.bucket(e,{refresh:function(){return a.wrapper(h,[d+e,g])}});return i.refresh()}a.wrapper(h,[d+e,g])},post:function(e,g){var h=b.post;if(f()){var i=c.bucket(e,{refresh:function(){return a.wrapper(h,[d+e,g])}});return i.refresh()}a.wrapper(h,[d+e,g])},put:function(e,g){var h=b.put;if(f()){var i=c.bucket(e,{refresh:function(){return a.wrapper(h,[d+e,g])}});return i.refresh()}a.wrapper(h,[d+e,g])},"delete":function(e,g){var h=b["delete"];if(f()){var i=c.bucket(e,{refresh:function(){return a.wrapper(h,[d+e,g])}});return i.refresh()}a.wrapper(h,[d+e,g])}}}]),angular.module("com.devnup.rest.util",[]).factory("$restUtil",[function(){if(!async)throw new Error("async is required");var a={};return a.wrapper=function(a,b){var c={success:angular.noop,error:angular.noop};a.apply(this,b).success(function(a){c.success(a)}).error(function(a){c.error(a)});var d={success:function(a){return c.success=a,d},error:function(a){return c.error=a,d}};return d},a.callback=function(a){var b={success:angular.noop,error:angular.noop};a=a||{},a.method=a.method||angular.copy(b),a.success=a.success||angular.noop,a.error=a.success||angular.noop,a.method.success(function(c){c.error?(a.error(c.error),b.error(c.error)):(a.success(c),b.success(c))}).error(function(c){a.error(c),b.error(c)});var c={success:function(a){return b.success=a,c},error:function(a){return b.error=a,c}};return c},a.$async=async,a}]);