"use strict";!function(){function a(a){return["$rootScope","$window",function(b,c){for(var d,e,f,g=c[a]||(console.warn("This browser does not support Web Storage!"),{}),h={$default:function(a){for(var b in a)angular.isDefined(h[b])||(h[b]=a[b]);return h},$reset:function(a){for(var b in h)"$"===b[0]||delete h[b];return h.$default(a)}},i=0;i<g.length;i++)(f=g.key(i))&&"ngStorage-"===f.slice(0,10)&&(h[f.slice(10)]=angular.fromJson(g.getItem(f)));return d=angular.copy(h),b.$watch(function(){e||(e=setTimeout(function(){if(e=null,!angular.equals(h,d)){angular.forEach(h,function(a,b){angular.isDefined(a)&&"$"!==b[0]&&g.setItem("ngStorage-"+b,angular.toJson(a)),delete d[b]});for(var a in d)g.removeItem("ngStorage-"+a);d=angular.copy(h)}},100))}),"localStorage"===a&&c.addEventListener&&c.addEventListener("storage",function(a){"ngStorage-"===a.key.slice(0,10)&&(a.newValue?h[a.key.slice(10)]=angular.fromJson(a.newValue):delete h[a.key.slice(10)],d=angular.copy(h),b.$apply())}),h}]}angular.module("ngStorage",[]).factory("$localStorage",a("localStorage")).factory("$sessionStorage",a("sessionStorage"))}(),angular.module("com.devnup.rest.cache.bucket",["com.devnup.rest.cache.storage","com.devnup.rest.util"]).factory("$cacheBucket",["$storageWrapper","$restUtil","$timeout",function(a,c,d){a.$local().$default({bucket:{},config:{min:5e3,max:6e4}});var e={},f={},g=a.$local(),h=function(a,b){return b=b||{},g.config=g.config||[],e[a]=b.refresh||angular.noop,g.bucket[a]={createdAt:Date.now(),lastUpdated:Date.now(),refreshing:!1,_data:{},timeout:{min:b.min||g.config.min,max:b.max||g.config.max,id:null}},i(a)},i=function(a,b,j){return j=j||{},g[a]=b=b||g[a]||h(a,j),j&&j.refresh&&(e[a]=j.refresh),b.refresh=function(){if(e[a]){var h=!!b._data||Object.keys(b._data).length,i=Date.now()-b.lastUpdated,k={min:j.min||b.timeout.min||g.config.min,max:j.max||b.timeout.max||g.config.max};if(!b.refreshing&&(!h||i>k.min))return b.refreshing=!0,c.callback({method:e[a](),success:function(c){b.lastUpdated=Date.now(),b._data=c,b.timeout.id=d(function(){b.refresh(f[a])},b.lastUpdated+k.max-Date.now()),b.refreshing=!1},error:function(){var c=b.lastUpdated+k.max-Date.now();b.timeout.id=d(function(){b.refresh(f[a])},c>=k.min?c:k.min),b.refreshing=!1}})}var l={error:function(){return l},success:function(a){return a(b._data),l}};return l},b.data=function(){return b._data},b.clear=function(){i.destroy(a)},b};return i.selector=function(a,b){return g.bucket[a]?i(a,g.bucket[a],b):h.apply(this,arguments)},i.destroy=function(){b?g.bucket[b]={}:g={}},i.config=function(a){a=a||{};for(var b in a)a.hasOwnProperty(b)&&(g.config[b]=a[b]||g[b])},i}]),angular.module("com.devnup.rest.cache.storage",["ngStorage"]).factory("$storageWrapper",["$rootScope","$localStorage","$sessionStorage",function(a,b,c){if(!b||!c)throw new Error("ngStorage is required");return{$local:function(){return b},$session:function(){return c}}}]),angular.module("com.devnup.rest.cache",["com.devnup.rest.cache.storage","com.devnup.rest.cache.bucket","com.devnup.rest.util"]).factory("$cache",["$storageWrapper","$restUtil","$timeout","$cacheBucket",function(a,b,c,d){return{bucket:function(a,b){return d.selector.apply(this,[a,b])},destroy:function(a){return d.destroy.apply(this,[a])},config:function(a){return d.config(a)}}}]),angular.module("com.devnup.rest",["com.devnup.rest.cache","com.devnup.rest.util"]).factory("$rest",["$restUtil","$http","$cache",function(a,b,c){var d="/api/",e=!1,f=function(){return!!e};return{callback:a.callback,config:function(a){d=a.base,e=a.cache,c.config(e)},get:function(e,g,h){var i=b.get;if(f()&&h.cache!==!1&&h.cache.enabled!==!1){var j=c.bucket("GET:"+e,{refresh:function(){return a.wrapper(i,[d+e,g,h.cache])}});return j.refresh()}return a.wrapper(i,[d+e,g,h.cache])},post:function(e,g,h){var i=b.post;if(f()&&h.cache!==!1){var j=c.bucket("POST:"+e,{refresh:function(){return a.wrapper(i,[d+e,g,h.cache])}});return j.refresh()}return a.wrapper(i,[d+e,g,h.cache])},put:function(e,g){var h=b.put;if(f()&&config.cache!==!1){var i=c.bucket("PUT:"+e,{refresh:function(){return a.wrapper(h,[d+e,g,config.cache])}});return i.refresh()}return a.wrapper(h,[d+e,g,config.cache])},"delete":function(e,g,h){var i=b["delete"];if(f()&&h.cache!==!1){var j=c.bucket("DEL:"+e,{refresh:function(){return a.wrapper(i,[d+e,g,h.cache])}});return j.refresh()}return a.wrapper(i,[d+e,g,h.cache])}}}]),angular.module("com.devnup.rest.util",[]).factory("$restUtil",[function(){if(!async)throw new Error("async is required");var a={};return a.wrapper=function(a,b){var c={success:angular.noop,error:angular.noop};a.apply(this,b).success(function(a){c.success(a)}).error(function(a){c.error(a)});var d={success:function(a){return c.success=a,d},error:function(a){return c.error=a,d}};return d},a.callback=function(a){var b={success:angular.noop,error:angular.noop};a=a||{},a.method=a.method||angular.copy(b),a.success=a.success||angular.noop,a.error=a.success||angular.noop,a.method.success(function(c){c.error?(a.error(c.error),b.error(c.error)):(a.success(c),b.success(c))}).error(function(c){a.error(c),b.error(c)});var c={success:function(a){return b.success=a,c},error:function(a){return b.error=a,c}};return c},a.$async=async,a}]);